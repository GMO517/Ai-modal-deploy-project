<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>格式化輸入顯示</title>

</head>
<link rel="stylesheet" href="./public/style.css">

<body>
  <input type="file" name="files" id="files" value="" />
  <div class="palette">
    <input type="color" name="" id="sec_1">
    <input type="color" name="" id="sec_2">
    <input type="color" name="" id="sec_3">
    <button type="button" id="changeColor_btn">BTN</button>
  </div>

  <div class="chat-messages" style="background-color:white;">
    <div class="title">資料顯示區塊</div>
  </div>

</body>

<script type="text/javascript">
  let files = document.getElementById('files');
  files.onchange = function () {
    let file = files.files[0];
    let reader = new FileReader();
    reader.readAsText(file);
    reader.onload = function () {
      let originData = reader.result;
      //未處理的資料
      const sectionKeyWord = "***";
      const splitKeyWord = "\n\r";
      //切割用keyword
      let section = originData.split(sectionKeyWord);

      // 先切三塊
      for (i = 0; i < section.length; i++) {
        createSectionDiv(section.length);
        let NewData = section[i].toString().split(splitKeyWord);
        let final = NewData.filter(function (value) {
          return value !== "\r";
        })
        // console.log(final.length);
        for (j = 0; j < final.length; j++) {
          createForm(final[j]);
        }
      }

      // Section_changeColor();


      function createSectionDiv(x) {
        // if (x % 2 == 1) {
        //   let color = '#ffa';
        // } else {
        //   let color = '#afa';
        // }

        //創造sectionDiv
        const secDiv = document.createElement('div');
        secDiv.classList.add('section');
        // const p = document.createElement('p');
        // p.classList.add('meta' + i);
        // div.appendChild(p);
        // secDiv.style.background = color;
        document.querySelector('.chat-messages').appendChild(secDiv);
      }
      function createForm(x) {
        //創造分句
        const div = document.createElement('div');
        div.classList.add('message');
        // const p = document.createElement('p');
        // p.classList.add('meta' + i);
        div.innerText = x;
        // div.appendChild(p);
        document.querySelector('.section').appendChild(div);
      }

      // function Section_changeColor() {
      //   changeColor_btn.onclick = function ChangeColor() {
      //     var sec_1 = document.getElementById("sec_1").value;
      //     var sec_2 = document.getElementById("sec_2").value;
      //     var sec_3 = document.getElementById("sec_3").value;
      //     let changeColor_btn = document.getElementById("changeColor_btn");

      //     for (j = 0; j < Math.round(NewData.length / 3); j++) {
      //       let rows = document.querySelector(".meta" + j);
      //       rows.style.background = sec_1;
      //       for (k = 29; k < NewData.length - Math.round(NewData.length / 3) - 3; k++) {
      //         let rows2 = document.querySelector(".meta" + k);
      //         rows2.style.background = sec_2;
      //         for (f = 54; f < NewData.length - 1; f++) {
      //           let rows3 = document.querySelector(".meta" + f);
      //           rows3.style.background = sec_3;
      //         };
      //       };
      //     };
      //   };
      // }

    }
  } 
</script>

</html>