<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>格式化輸入顯示</title>

</head>
<link rel="stylesheet" href="./testData/public/style.css">

<body>
  <input type="file" name="files" id="files" value="" />
  <div class="palette">
    <input type="color" name="" id="sec_1">
    <input type="color" name="" id="sec_2">
    <input type="color" name="" id="sec_3">
    <button type="button" id="changeColor_btn">BTN</button>
  </div>
  <div class="chat-messages" style="background-color:white;">
    <div class="title">資料顯示區塊</div>
  </div>
</body>

<script type="text/javascript">
  let files = document.getElementById('files');
  files.onchange = function () {
    let file = files.files[0];
    let reader = new FileReader();
    reader.readAsText(file);

    reader.onload = function () {
      let originData = reader.result;
      //未處理的資料
      const sectionKeyWord = "*************************************************************************";
      const splitKeyWord = "\n";
      //切割用keyword
      let section = originData.split(sectionKeyWord);

      console.log(sectionKeyWord);
      console.log(section);
      // 先切三塊
      let NewData = section.toString().split(splitKeyWord);
      //再切分句 **記得要轉回字串才能處理
      // console.log(NewData[0]);
      //一行一行拆開來列印 TODO
      // for (i = 0; i < NewData.length; i++) {
      //   // console.log(NewData[i]);
      //   //過濾空句子
      //   if (NewData[i] != "") {
      //     Section_changeColor(NewData[i]);
      //   }
      // }

      Section_changeColor();

      function Section_changeColor() {


        for (i = 0; i < NewData.length; i++) {

          if (NewData[i] != "") {

            const div = document.createElement('div');
            div.classList.add('message');
            const p = document.createElement('p');
            p.classList.add('meta' + i);
            p.innerText = NewData[i];
            div.appendChild(p);
            document.querySelector('.chat-messages').appendChild(div);

          };
        };


        changeColor_btn.onclick = function ChangeColor() {
          var sec_1 = document.getElementById("sec_1").value;
          var sec_2 = document.getElementById("sec_2").value;
          var sec_3 = document.getElementById("sec_3").value;
          let changeColor_btn = document.getElementById("changeColor_btn");

          for (j = 0; j < Math.round(NewData.length / 3); j++) {
            let rows = document.querySelector(".meta" + j);
            rows.style.background = sec_1;

            for (k = 29; k < NewData.length - Math.round(NewData.length / 3) - 3; k++) {
              let rows2 = document.querySelector(".meta" + k);
              rows2.style.background = sec_2;

              for (f = 54; f < NewData.length - 1; f++) {
                let rows3 = document.querySelector(".meta" + f);
                rows3.style.background = sec_3;
              };

            };

          };
        };




      }

      // function createForm(x) {
      //   //創造form區 
      //   const div = document.createElement('div');
      //   div.classList.add('message');
      //   const p = document.createElement('p');
      //   p.classList.add('meta');
      //   p.innerText = x;
      //   div.appendChild(p);
      //   document.querySelector('.chat-messages').appendChild(div);
      // }
    }
  } 
</script>

</html>