<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>格式化輸入顯示</title>
  <script src="https://code.jquery.com/jquery-3.6.3.js" integrity="sha256-nQLuAZGRRcILA+6dMBOvcRh5Pe310sBpanc6+QBmyVM="
    crossorigin="anonymous"></script>
  <!-- <script>
    $(document).ready(function () {
      $.ajax({
        url: "./testData/data/11.txt",
        dataType: "text",
        success: function (data) {
          $(".chat-messages").html(data);
        }
      });
    }); 
  </script> -->
</head>

<body>
  <input type="file" name="files" id="files" value="" />
  <!-- <button id="btn" type="button">按我</button> -->
  <div class="chat-messages" style="background-color: rgb(106, 183, 255);">
    資料顯示區塊
  </div>
</body>

<script type="text/javascript">
  let files = document.getElementById('files');
  files.onchange = function () {
    let file = files.files[0];
    let reader = new FileReader();
    reader.readAsText(file);

    reader.onload = function () {
      let originData = reader.result;




      //未處理的資料
      const sectionKeyWord = "*************************************************************************";
      const splitKeyWord = "\n";
      //切割用keyword
      let section = originData.split(sectionKeyWord);

      // console.log(sectionKeyWord);
      // console.log(section);
      // 先切三塊

      //再切分句 **記得要轉回字串才能處理
      // console.log(NewData[0]);

      for (i = 0; i < section.length; i++) {
        // console.log(section[i]); 
        let NewData = section.toString().split(splitKeyWord);
        NewData.toString().replace('〈', '●');
        // NewData.replace('〕', '●')
        console.log(NewData);
        for (i = 0; i < NewData.length; i++) {
          // console.log(NewData[i]);
          //過濾空句子
          if (NewData[i] != null) {
            createForm(NewData[i]);
          }
        }
      }

      function createForm(x) {
        //創造form區 
        const div = document.createElement('div');
        div.classList.add('message');
        const p = document.createElement('p');
        p.classList.add('meta');
        p.innerText = x;
        div.appendChild(p);
        document.querySelector('.chat-messages').appendChild(div);
      }
    }
  }
</script>

</html>